{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport { MatPaginator } from '@angular/material/paginator';\nimport { MatTableDataSource } from '@angular/material/table';\nimport ValidateForm from 'src/app/helper/validateForm';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/auth.service\";\nimport * as i2 from \"src/app/services/api.service\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/material/table\";\nimport * as i7 from \"@angular/material/paginator\";\nimport * as i8 from \"@angular/material/button\";\nfunction HomeComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"div\");\n  }\n}\nfunction HomeComponent_ng_template_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 31);\n    i0.ɵɵlistener(\"click\", function HomeComponent_ng_template_6_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r14.logInRedirect());\n    });\n    i0.ɵɵtext(1, \"Log in\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction HomeComponent_ng_template_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r17 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 31);\n    i0.ɵɵlistener(\"click\", function HomeComponent_ng_template_8_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r17);\n      const ctx_r16 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r16.logOut());\n    });\n    i0.ɵɵtext(1, \"Sign out\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction HomeComponent_th_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 32);\n    i0.ɵɵtext(1, \" Shortened \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction HomeComponent_td_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 33)(1, \"a\", 34);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const element_r18 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"href\", element_r18.shortened, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(element_r18.shortened);\n  }\n}\nfunction HomeComponent_th_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 32);\n    i0.ɵɵtext(1, \" LongUrl \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction HomeComponent_td_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 33);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const element_r19 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", element_r19.longUrl, \" \");\n  }\n}\nfunction HomeComponent_th_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 35);\n    i0.ɵɵtext(1, \" Action \");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r9 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"hidden\", !ctx_r9.isAuthorized());\n  }\n}\nfunction HomeComponent_td_23_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r22 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"td\", 36)(1, \"button\", 37);\n    i0.ɵɵlistener(\"click\", function HomeComponent_td_23_Template_button_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r22);\n      const element_r20 = restoredCtx.$implicit;\n      const ctx_r21 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r21.getUrlInfo(element_r20));\n    });\n    i0.ɵɵtext(2, \"Info\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 38);\n    i0.ɵɵlistener(\"click\", function HomeComponent_td_23_Template_button_click_3_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r22);\n      const element_r20 = restoredCtx.$implicit;\n      const ctx_r23 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r23.deleteShortenedUrl(element_r20));\n    });\n    i0.ɵɵtext(4, \"Delete\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const element_r20 = ctx.$implicit;\n    const ctx_r10 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"hidden\", !ctx_r10.isAuthorized());\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"hidden\", false);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"hidden\", !ctx_r10.isVisible(element_r20));\n  }\n}\nfunction HomeComponent_tr_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 39);\n  }\n}\nfunction HomeComponent_tr_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 40);\n  }\n}\nfunction HomeComponent_small_38_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 41);\n    i0.ɵɵtext(1, \"Url is required\");\n    i0.ɵɵelementEnd();\n  }\n}\nconst _c0 = function () {\n  return [5, 10, 15];\n};\nexport class HomeComponent {\n  constructor(auth, api, fb, router) {\n    this.auth = auth;\n    this.api = api;\n    this.fb = fb;\n    this.router = router;\n    this.shortenedUrls = [];\n    this.displayedColumns = ['LongUrl', 'Shortened', 'Action'];\n  }\n  ngOnInit() {\n    this.api.Refresh$.subscribe(() => {\n      this.getUrls();\n    });\n    this.getUrls();\n    this.createUrlForm = this.fb.group({\n      Url: ['', Validators.required]\n    });\n  }\n  getUrls() {\n    this.api.getShortenedUrls().subscribe(res => {\n      this.shortenedUrls = res;\n      this.dataSource = new MatTableDataSource(this.shortenedUrls);\n      this.dataSource.paginator = this.paginator;\n    });\n  }\n  logOut() {\n    this.auth.signOut();\n  }\n  addNewUrl() {\n    if (this.createUrlForm.value) {\n      this.api.addUrl(this.createUrlForm.value);\n    } else {\n      ValidateForm.validateAllFormField(this.createUrlForm);\n    }\n  }\n  deleteShortenedUrl(row) {\n    this.api.deleteShortenedUrl(row);\n  }\n  getUrlInfo(row) {\n    this.router.navigate(['url-info'], {\n      queryParams: {\n        data: JSON.stringify(row)\n      }\n    });\n  }\n  isAuthorized() {\n    return this.auth.isLoggedIn();\n  }\n  logInRedirect() {\n    this.router.navigate(['login']);\n  }\n  isVisible(urlObj) {\n    if (this.isAuthorized()) {\n      if (this.isAdminOrOwner(urlObj)) {\n        return true;\n      }\n    }\n    return false;\n  }\n  isAdminOrOwner(urlObj) {\n    var role = this.auth.getUserRoleFromToken();\n    var id = this.auth.getUserIdFromToken();\n    if (role === \"admin\") {\n      return true;\n    }\n    if (id === urlObj.userId) {\n      return true;\n    }\n    return false;\n  }\n}\nHomeComponent.ɵfac = function HomeComponent_Factory(t) {\n  return new (t || HomeComponent)(i0.ɵɵdirectiveInject(i1.AuthService), i0.ɵɵdirectiveInject(i2.ApiService), i0.ɵɵdirectiveInject(i3.FormBuilder), i0.ɵɵdirectiveInject(i4.Router));\n};\nHomeComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: HomeComponent,\n  selectors: [[\"app-home\"]],\n  viewQuery: function HomeComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(MatPaginator, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.paginator = _t.first);\n    }\n  },\n  decls: 41,\n  vars: 14,\n  consts: [[1, \"outer\"], [1, \"container-home\"], [1, \"bg-dark-subtle\", \"mb-5\"], [1, \"nav\", \"justify-content-end\"], [1, \"nav-item\", \"d-inline-flex\"], [4, \"ngIf\", \"ngIfThen\", \"ngIfElse\"], [\"loginButton\", \"\"], [\"signoutButton\", \"\"], [1, \"btn-pimary\"], [1, \"container\", \"bg-white\"], [\"mat-table\", \"\", 1, \"mat-elevation-z8\", 3, \"dataSource\"], [\"matColumnDef\", \"Shortened\"], [\"mat-header-cell\", \"\", 4, \"matHeaderCellDef\"], [\"mat-cell\", \"\", 4, \"matCellDef\"], [\"matColumnDef\", \"LongUrl\"], [\"matColumnDef\", \"Action\"], [\"mat-header-cell\", \"\", 3, \"hidden\", 4, \"matHeaderCellDef\"], [\"mat-cell\", \"\", 3, \"hidden\", 4, \"matCellDef\"], [\"mat-header-row\", \"\", 4, \"matHeaderRowDef\"], [\"mat-row\", \"\", 4, \"matRowDef\", \"matRowDefColumns\"], [3, \"pageSize\", \"pageSizeOptions\"], [1, \"container-addUrl\", 3, \"hidden\"], [1, \"pt-3\", \"font-weight-bold\", \"text-center\"], [1, \"panel\", \"border\", \"bg-white\"], [1, \"panel-body\", \"p-3\"], [3, \"formGroup\"], [1, \"form-group\", \"pt-3\"], [1, \"input-field\"], [\"formControlName\", \"Url\", \"type\", \"text\", \"placeholder\", \"Url\"], [\"class\", \"text-danger fs-6\", 4, \"ngIf\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"disabled\", \"click\"], [1, \"btn\", \"btn-primary\", 3, \"click\"], [\"mat-header-cell\", \"\"], [\"mat-cell\", \"\"], [3, \"href\"], [\"mat-header-cell\", \"\", 3, \"hidden\"], [\"mat-cell\", \"\", 3, \"hidden\"], [\"mat-stroked-button\", \"\", \"color\", \"primary\", 3, \"hidden\", \"click\"], [\"mat-stroked-button\", \"\", \"color\", \"warn\", 3, \"hidden\", \"click\"], [\"mat-header-row\", \"\"], [\"mat-row\", \"\"], [1, \"text-danger\", \"fs-6\"]],\n  template: function HomeComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"nav\", 2)(3, \"ul\", 3)(4, \"li\", 4);\n      i0.ɵɵtemplate(5, HomeComponent_div_5_Template, 1, 0, \"div\", 5);\n      i0.ɵɵtemplate(6, HomeComponent_ng_template_6_Template, 2, 0, \"ng-template\", null, 6, i0.ɵɵtemplateRefExtractor);\n      i0.ɵɵtemplate(8, HomeComponent_ng_template_8_Template, 2, 0, \"ng-template\", null, 7, i0.ɵɵtemplateRefExtractor);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(10, \"li\")(11, \"button\", 8);\n      i0.ɵɵtext(12, \" (click)=\\\"toAbout()\\\"\");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(13, \"div\", 9)(14, \"table\", 10);\n      i0.ɵɵelementContainerStart(15, 11);\n      i0.ɵɵtemplate(16, HomeComponent_th_16_Template, 2, 0, \"th\", 12);\n      i0.ɵɵtemplate(17, HomeComponent_td_17_Template, 3, 2, \"td\", 13);\n      i0.ɵɵelementContainerEnd();\n      i0.ɵɵelementContainerStart(18, 14);\n      i0.ɵɵtemplate(19, HomeComponent_th_19_Template, 2, 0, \"th\", 12);\n      i0.ɵɵtemplate(20, HomeComponent_td_20_Template, 2, 1, \"td\", 13);\n      i0.ɵɵelementContainerEnd();\n      i0.ɵɵelementContainerStart(21, 15);\n      i0.ɵɵtemplate(22, HomeComponent_th_22_Template, 2, 1, \"th\", 16);\n      i0.ɵɵtemplate(23, HomeComponent_td_23_Template, 5, 3, \"td\", 17);\n      i0.ɵɵelementContainerEnd();\n      i0.ɵɵtemplate(24, HomeComponent_tr_24_Template, 1, 0, \"tr\", 18);\n      i0.ɵɵtemplate(25, HomeComponent_tr_25_Template, 1, 0, \"tr\", 19);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(26, \"div\", 9);\n      i0.ɵɵelement(27, \"mat-paginator\", 20);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(28, \"div\")(29, \"div\", 21)(30, \"h3\", 22);\n      i0.ɵɵtext(31, \"New url\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(32, \"div\", 23)(33, \"div\", 24)(34, \"form\", 25)(35, \"div\", 26)(36, \"div\", 27);\n      i0.ɵɵelement(37, \"input\", 28);\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(38, HomeComponent_small_38_Template, 2, 0, \"small\", 29);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(39, \"button\", 30);\n      i0.ɵɵlistener(\"click\", function HomeComponent_Template_button_click_39_listener() {\n        return ctx.addNewUrl();\n      });\n      i0.ɵɵtext(40, \"Add new url\");\n      i0.ɵɵelementEnd()()()()()()();\n    }\n    if (rf & 2) {\n      const _r1 = i0.ɵɵreference(7);\n      const _r3 = i0.ɵɵreference(9);\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngIf\", ctx.isAuthorized())(\"ngIfThen\", _r3)(\"ngIfElse\", _r1);\n      i0.ɵɵadvance(9);\n      i0.ɵɵproperty(\"dataSource\", ctx.dataSource);\n      i0.ɵɵadvance(10);\n      i0.ɵɵproperty(\"matHeaderRowDef\", ctx.displayedColumns);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"matRowDefColumns\", ctx.displayedColumns);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"pageSize\", 5)(\"pageSizeOptions\", i0.ɵɵpureFunction0(13, _c0));\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"hidden\", !ctx.isAuthorized());\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"formGroup\", ctx.createUrlForm);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngIf\", ctx.createUrlForm.controls[\"Url\"].dirty && ctx.createUrlForm.hasError(\"required\", \"Url\"));\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"disabled\", ctx.createUrlForm.invalid)(\"disabled\", ctx.isAuthorized());\n    }\n  },\n  dependencies: [i5.NgIf, i3.ɵNgNoValidate, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgControlStatusGroup, i3.FormGroupDirective, i3.FormControlName, i6.MatTable, i6.MatHeaderCellDef, i6.MatHeaderRowDef, i6.MatColumnDef, i6.MatCellDef, i6.MatRowDef, i6.MatHeaderCell, i6.MatCell, i6.MatHeaderRow, i6.MatRow, i7.MatPaginator, i8.MatButton],\n  styles: [\"table[_ngcontent-%COMP%] {\\r\\n    width: 100%;\\r\\n  }\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50cy9ob21lL2hvbWUuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtJQUNJLFdBQVc7RUFDYiIsInNvdXJjZXNDb250ZW50IjpbInRhYmxlIHtcclxuICAgIHdpZHRoOiAxMDAlO1xyXG4gIH0iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n});","map":{"version":3,"mappings":"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","names":["Validators","MatPaginator","MatTableDataSource","ValidateForm","i0","HomeComponent","constructor","auth","api","fb","router","ngOnInit","Refresh$","subscribe","getUrls","createUrlForm","group","Url","required","getShortenedUrls","res","shortenedUrls","dataSource","paginator","logOut","signOut","addNewUrl","value","addUrl","validateAllFormField","deleteShortenedUrl","row","getUrlInfo","navigate","queryParams","data","JSON","stringify","isAuthorized","isLoggedIn","logInRedirect","isVisible","urlObj","isAdminOrOwner","role","getUserRoleFromToken","id","getUserIdFromToken","userId","selectors","viewQuery","ctx"],"sourceRoot":"","sources":["F:\\UrlShortnerApi\\UI\\UrlShortnerUI\\src\\app\\components\\home\\home.component.ts","F:\\UrlShortnerApi\\UI\\UrlShortnerUI\\src\\app\\components\\home\\home.component.html"],"sourcesContent":["import { Component, OnInit, ViewChild } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { MatPaginator } from '@angular/material/paginator';\nimport { MatTableDataSource } from '@angular/material/table';\nimport { NavigationExtras, Router } from '@angular/router';\nimport ValidateForm from 'src/app/helper/validateForm';\nimport { ShortenedUrls } from 'src/app/models/ShortenedUrl';\nimport { ApiService } from 'src/app/services/api.service';\nimport { AuthService } from 'src/app/services/auth.service';\n\n@Component({\n  selector: 'app-home',\n  templateUrl: './home.component.html',\n  styleUrls: ['./home.component.css']\n})\n\nexport class HomeComponent implements OnInit {\n\n  @ViewChild(MatPaginator) paginator !: MatPaginator;\n\n  public shortenedUrls: any[] = [];\n  public observable$: any;\n  displayedColumns: string[] = ['LongUrl', 'Shortened', 'Action'];\n  dataSource: any;\n\n  createUrlForm!: FormGroup;\n\n  constructor(private auth: AuthService, private api: ApiService, private fb: FormBuilder, private router: Router) { }\n\n  ngOnInit(): void {\n\n    this.api.Refresh$.subscribe(() => {\n      this.getUrls()\n    })\n\n    this.getUrls();\n    this.createUrlForm = this.fb.group({\n      Url: ['', Validators.required],\n    });\n  }\n\n  private getUrls() {\n    this.api.getShortenedUrls()\n      .subscribe(res => {\n        this.shortenedUrls = res;\n        this.dataSource = new MatTableDataSource(this.shortenedUrls);\n        this.dataSource.paginator = this.paginator;\n      });\n  }\n\n  logOut() {\n    this.auth.signOut();\n  }\n\n  addNewUrl() {\n    if (this.createUrlForm.value) {\n      this.api.addUrl(this.createUrlForm.value);\n    } else {\n      ValidateForm.validateAllFormField(this.createUrlForm)\n    }\n  }\n\n  deleteShortenedUrl(row: any) {\n    this.api.deleteShortenedUrl(row);\n  }\n\n  getUrlInfo(row: any) {\n    this.router.navigate(['url-info'], { queryParams: { data: JSON.stringify(row) } });\n  }\n\n  isAuthorized(): boolean {\n    return this.auth.isLoggedIn();\n  }\n\n  logInRedirect() {\n    this.router.navigate(['login']);\n  }\n\n  isVisible(urlObj: any) {\n    if (this.isAuthorized()) {\n      if (this.isAdminOrOwner(urlObj)) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  isAdminOrOwner(urlObj: any) {\n    var role = this.auth.getUserRoleFromToken();\n    var id = this.auth.getUserIdFromToken();\n\n    if (role === \"admin\") {\n      return true;\n    }\n\n    if (id === urlObj.userId) {\n      return true;\n    }\n\n    return false;\n  }\n}\n","<div class=\"outer\">\n  <div class=\"container-home\">\n    <nav class=\"bg-dark-subtle mb-5\">\n      <ul class=\"nav justify-content-end\">\n        <li class=\"nav-item d-inline-flex\">\n          <div *ngIf=\"isAuthorized(); then signoutButton else loginButton\"></div>\n\n            <ng-template #loginButton>\n              <button (click)=\"logInRedirect()\" class=\"btn btn-primary\">Log in</button>\n            </ng-template>\n\n            <ng-template #signoutButton>\n              <button (click)=\"logOut()\" class=\"btn btn-primary\">Sign out</button>\n            </ng-template>\n            \n        </li>\n        <li>\n          <button class=\"btn-pimary\"> (click)=\"toAbout()\"</button>\n        </li>\n      </ul>\n    </nav>\n    <div class=\"container bg-white\">\n      <table mat-table [dataSource]=\"dataSource\" class=\"mat-elevation-z8\">\n\n        <ng-container matColumnDef=\"Shortened\">\n          <th mat-header-cell *matHeaderCellDef> Shortened </th>\n          <td mat-cell *matCellDef=\"let element\">\n            <a href=\"{{element.shortened}}\">{{ element.shortened }}</a>\n          </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"LongUrl\">\n          <th mat-header-cell *matHeaderCellDef> LongUrl </th>\n          <td mat-cell *matCellDef=\"let element\"> {{element.longUrl}} </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"Action\">\n          <th mat-header-cell *matHeaderCellDef [hidden]=\"!isAuthorized()\"> Action </th>\n          <td mat-cell *matCellDef=\"let element\" [hidden]=\"!isAuthorized()\">\n            <button mat-stroked-button (click)=\"getUrlInfo(element)\" [hidden]=\"false\" color=\"primary\">Info</button>\n            <button mat-stroked-button (click)=\"deleteShortenedUrl(element)\" [hidden]=\"!isVisible(element)\" color=\"warn\">Delete</button>\n          </td>\n        </ng-container>\n        <tr mat-header-row *matHeaderRowDef=\"displayedColumns\"></tr>\n\n        <tr mat-row *matRowDef=\"let row; columns: displayedColumns;\">\n        </tr>\n      </table>\n    </div>\n  </div>\n\n  <div class=\"container bg-white\">\n    <mat-paginator [pageSize]=\"5\" [pageSizeOptions]=\"[5, 10, 15]\"></mat-paginator>\n  </div>\n\n  <div>\n    <div class=\"container-addUrl\" [hidden]=\"!isAuthorized()\">\n      <h3 class=\"pt-3 font-weight-bold text-center\">New url</h3>\n      <div class=\"panel border bg-white\">\n        <div class=\"panel-body p-3\">\n          <form [formGroup]=\"createUrlForm\">\n            <div class=\"form-group pt-3\">\n              <div class=\"input-field\">\n                <input formControlName=\"Url\" type=\"text\" placeholder=\"Url\">\n              </div>\n              <small *ngIf=\"createUrlForm.controls['Url'].dirty && createUrlForm.hasError('required', 'Url')\"\n                class=\"text-danger fs-6\">Url is required</small>\n            </div>\n            <button (click)=\"addNewUrl()\" [disabled]=\"createUrlForm.invalid\" [disabled]=\"isAuthorized()\" type=\"submit\" class=\"btn btn-primary\">Add\n              new url</button>\n          </form>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}